import { arrayBufferToHexString, encrypt } from "../utils/encrypt";
export const _save_state = async (config, idToken) => {
    const text = JSON.stringify({ config, idToken });
    const [key, iv, cipher] = await encrypt(text);
    const keyRaw = await window.crypto.subtle.exportKey("raw", key);
    const keyString = arrayBufferToHexString(keyRaw);
    const cipherString = arrayBufferToHexString(cipher);
    const ivString = arrayBufferToHexString(iv);
    document.cookie = `ngx_oauth2_oidc=${keyString}${ivString}; secure; samesite=strict`;
    sessionStorage.setItem("oauth2_unload", cipherString);
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiX3NhdmVTdGF0ZS5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL3Byb2plY3RzL25neC1vYXV0aDItb2lkYy9zcmMvbGliL19zYXZlU3RhdGUudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQ0EsT0FBTyxFQUFFLHNCQUFzQixFQUFFLE9BQU8sRUFBRSxNQUFNLGtCQUFrQixDQUFDO0FBRW5FLE1BQU0sQ0FBQyxNQUFNLFdBQVcsR0FBRyxLQUFLLEVBQzVCLE1BQXFCLEVBQ3JCLE9BQW1CLEVBQ3JCLEVBQUU7SUFDQSxNQUFNLElBQUksR0FBRyxJQUFJLENBQUMsU0FBUyxDQUFDLEVBQUMsTUFBTSxFQUFFLE9BQU8sRUFBQyxDQUFDLENBQUM7SUFDL0MsTUFBTSxDQUFDLEdBQUcsRUFBRSxFQUFFLEVBQUUsTUFBTSxDQUFDLEdBQUcsTUFBTSxPQUFPLENBQUMsSUFBSSxDQUFDLENBQUM7SUFDOUMsTUFBTSxNQUFNLEdBQUcsTUFBTSxNQUFNLENBQUMsTUFBTSxDQUFDLE1BQU0sQ0FBQyxTQUFTLENBQUMsS0FBSyxFQUFFLEdBQUcsQ0FBQyxDQUFDO0lBQ2hFLE1BQU0sU0FBUyxHQUFHLHNCQUFzQixDQUFDLE1BQU0sQ0FBQyxDQUFDO0lBQ2pELE1BQU0sWUFBWSxHQUFHLHNCQUFzQixDQUFDLE1BQU0sQ0FBQyxDQUFDO0lBQ3BELE1BQU0sUUFBUSxHQUFHLHNCQUFzQixDQUFDLEVBQUUsQ0FBQyxDQUFDO0lBRTVDLFFBQVEsQ0FBQyxNQUFNLEdBQUcsbUJBQW1CLFNBQVMsR0FBRyxRQUFRLDJCQUEyQixDQUFDO0lBQ3JGLGNBQWMsQ0FBQyxPQUFPLENBQUMsZUFBZSxFQUFFLFlBQVksQ0FBQyxDQUFDO0FBQzFELENBQUMsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IElPQXV0aDJDb25maWcsIGpzb25PYmplY3QgfSBmcm9tIFwiLi4vZG9tYWluXCI7XG5pbXBvcnQgeyBhcnJheUJ1ZmZlclRvSGV4U3RyaW5nLCBlbmNyeXB0IH0gZnJvbSBcIi4uL3V0aWxzL2VuY3J5cHRcIjtcblxuZXhwb3J0IGNvbnN0IF9zYXZlX3N0YXRlID0gYXN5bmMgKFxuICAgIGNvbmZpZzogSU9BdXRoMkNvbmZpZyxcbiAgICBpZFRva2VuOiBqc29uT2JqZWN0XG4pID0+IHtcbiAgICBjb25zdCB0ZXh0ID0gSlNPTi5zdHJpbmdpZnkoe2NvbmZpZywgaWRUb2tlbn0pO1xuICAgIGNvbnN0IFtrZXksIGl2LCBjaXBoZXJdID0gYXdhaXQgZW5jcnlwdCh0ZXh0KTtcbiAgICBjb25zdCBrZXlSYXcgPSBhd2FpdCB3aW5kb3cuY3J5cHRvLnN1YnRsZS5leHBvcnRLZXkoXCJyYXdcIiwga2V5KTtcbiAgICBjb25zdCBrZXlTdHJpbmcgPSBhcnJheUJ1ZmZlclRvSGV4U3RyaW5nKGtleVJhdyk7XG4gICAgY29uc3QgY2lwaGVyU3RyaW5nID0gYXJyYXlCdWZmZXJUb0hleFN0cmluZyhjaXBoZXIpO1xuICAgIGNvbnN0IGl2U3RyaW5nID0gYXJyYXlCdWZmZXJUb0hleFN0cmluZyhpdik7XG5cbiAgICBkb2N1bWVudC5jb29raWUgPSBgbmd4X29hdXRoMl9vaWRjPSR7a2V5U3RyaW5nfSR7aXZTdHJpbmd9OyBzZWN1cmU7IHNhbWVzaXRlPXN0cmljdGA7XG4gICAgc2Vzc2lvblN0b3JhZ2Uuc2V0SXRlbShcIm9hdXRoMl91bmxvYWRcIiwgY2lwaGVyU3RyaW5nKTtcbn07XG4iXX0=